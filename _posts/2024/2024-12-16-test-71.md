---
layout: minimal_post
title: "대규모 시스템 설계: 확장성 있는 아키텍처 패턴"
date: 2024-12-16 12:00:00 +0900
categories: [Tech, System Design]
tags: [Architecture, Backend, Scalability]
---

# 확장성(Scalability) 있는 시스템 설계

수백만 명의 사용자를 처리하는 시스템을 설계할 때 고려해야 할 핵심 원칙과 패턴들을 살펴봅니다.

## 1. 수직 확장 vs 수평 확장

시스템의 용량을 늘리는 방법은 크게 두 가지가 있습니다.

### 수직 확장 (Vertical Scaling)
*   **개념**: 단일 서버의 하드웨어(CPU, RAM) 성능을 업그레이드.
*   **장점**: 구현이 단순함.
*   **단점**: 하드웨어 한계가 명확하며, 비용이 기하급수적으로 증가. 단일 장애 지점(SPOF) 위험.

### 수평 확장 (Horizontal Scaling)
*   **개념**: 더 많은 서버(인스턴스)를 추가하여 부하를 분산.
*   **장점**: 무한에 가까운 확장 가능, 장애 격리 용이.
*   **단점**: 로드 밸런싱, 데이터 일관성 등 관리가 복잡해짐.

## 2. 로드 밸런서 (Load Balancer)

트래픽을 여러 서버로 분산시키는 핵심 컴포넌트입니다.

*   **L4 로드 밸런싱**: 전송 계층(IP, Port) 기준 분산. 빠르지만 덜 똑똑함.
*   **L7 로드 밸런싱**: 애플리케이션 계층(HTTP Header, URL) 기준 분산. 유연하지만 비용이 높음.

```bash
# Nginx 로드 밸런싱 설정 예시
http {
    upstream backend {
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}
```

## 3. 데이터베이스 샤딩 (Sharding)

단일 데이터베이스의 한계를 극복하기 위해 데이터를 여러 노드에 분할 저장하는 기술입니다.

### 샤딩 전략

1.  **Range Based**: 특정 범위(예: 날짜, ID 구간)로 분할.
    *   *장점*: 쿼리 작성이 쉬움.
    *   *단점*: 데이터 불균형(Hotspot) 발생 가능.
2.  **Hash Based**: 샤딩 키의 해시값을 기준으로 분할.
    *   *장점*: 데이터가 균등하게 분포됨.
    *   *단점*: 노드 추가/삭제 시 재배치(Resharding) 비용이 큼.

| 전략 | 장점 | 단점 |
| :--- | :--- | :--- |
| **Range** | 범위 쿼리 효율적 | 특정 샤드 과부하 위험 |
| **Hash** | 균등한 데이터 분포 | 범위 쿼리 어려움 |

## 4. 캐싱 (Caching) 전략

데이터베이스 부하를 줄이고 응답 속도를 높이는 가장 효과적인 방법입니다.

> "캐시는 읽기(Read)가 많은 시스템에서 마법과 같은 성능 향상을 가져옵니다."

*   **Look-aside (Lazy Loading)**:
    1.  캐시에 데이터 요청
    2.  없으면(Miss) DB에서 조회
    3.  DB 결과를 캐시에 저장 후 반환
*   **Write-through**:
    1.  데이터를 캐시와 DB에 동시에 씀
    2.  데이터 일관성은 높으나 쓰기 성능이 저하됨

---

### 결론

확장성 있는 아키텍처는 정답이 없습니다. 트레이드오프(Trade-off)를 이해하고 현재 비즈니스 요구사항에 맞는 최선의 선택을 하는 것이 중요합니다.